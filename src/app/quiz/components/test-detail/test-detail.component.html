<div class="test-detail-container">
  <h2>Create New Test</h2>
  <form [formGroup]="testForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="testName">Test Name</label>
      <input id="testName" type="text" formControlName="testName" class="form-control"
             [ngClass]="{ 'is-invalid': submitted && f['testName'].invalid }" />
      <div *ngIf="submitted && f['testName'].invalid" class="invalid-feedback">
        Test Name is required.
      </div>
    </div>

    <div class="form-group">
      <label for="description">Description</label>
      <textarea id="description" formControlName="description" class="form-control"></textarea>
    </div>

    <div class="form-group">
      <label for="duration">Duration (minutes)</label>
      <input id="duration" type="number" formControlName="duration" class="form-control"
             [ngClass]="{ 'is-invalid': submitted && f['duration'].invalid }" />
      <div *ngIf="submitted && f['duration'].invalid" class="invalid-feedback">
        <div *ngIf="f['duration'].errors?.['required']">Duration is required.</div>
        <div *ngIf="f['duration'].errors?.['min']">Duration must be at least 1 minute.</div>
      </div>
    </div>

    <!-- Question Filters -->
    <h3>Available Questions</h3>
    <div class="filter-container">
      <label>Subject:</label>
      <select [(ngModel)]="filter.subject" (change)="applyFilters()">
        <option value="">All Subjects</option>
        <option *ngFor="let subject of subjects" [value]="subject">{{ subject }}</option>
      </select>

      <label>Topic:</label>
      <select [(ngModel)]="filter.topic" (change)="applyFilters()">
        <option value="">All Topics</option>
        <option *ngFor="let topic of topics" [value]="topic">{{ topic }}</option>
      </select>

      <label>Exam:</label>
      <select [(ngModel)]="filter.exam" (change)="applyFilters()">
        <option value="">All Exams</option>
        <option *ngFor="let exam of exams" [value]="exam">{{ exam }}</option>
      </select>

      <label>Type:</label>
      <select [(ngModel)]="filter.questionType" (change)="applyFilters()">
        <option value="">All Types</option>
        <option *ngFor="let type of questionTypes" [value]="type">{{ type }}</option>
      </select>
    </div>

    <!-- Question List with Checkboxes -->
    <div class="question-list">
      <div *ngFor="let question of filteredQuestions">
        <input type="checkbox" [checked]="isSelected(question.id)" (change)="toggleQuestionSelection(question.id)" />
        <span>{{ question.text }}</span> - <em>{{ question.subject }} / {{ question.topic }} / {{ question.exam }}</em>
      </div>
    </div>

    <button type="submit" class="btn btn-primary">Create Test</button>
  </form>
</div>
